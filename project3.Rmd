---
title: "ST 558 Project 3"
author: "Katelyn Settlemyre, Xi Zeng"
date: "2022-10-13"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Package List  
Below is the package list needed for this project.
```{r}
library(readr)
library(tidyverse)
library(caret)
library(ggplot2)  
```

# Introduction  
The data set used for analysis is the `OnlineNewsPopularity` data set from UCI Machine Learning Repository. The data set has 61 variables in total, as well as 39644 observations. First, we will take a subset data set by filter according to the data channel. The lifestyle channel is first chosen for analysis.  
For our project, we will take variables(With description of each variable):
+ n_tokens_title: Number of words in the title  
+ n_tokens_content: Number of words in the content  
+ num_imgs: Number of images  
+ average_token_length: Average length of the words in the content  
+ is_weekend: Was the article published on the weekend?  
+ global_rate_positive_words: Rate of positive words in the content  
+ num_keywords: Number of keywords in the metadata  

The response variable that we are interested in is the `shares` variable, which stands for the number of sales in social network. A basic EDA will be performed at first to examine the relationship between covariates and `shares`. Then predicted modeling is applied to predict the number of sales, which will be illustrated in detail below.

# Data read in
```{r}
#Read in data
news <- read_csv("OnlineNewsPopularity.csv",show_col_types = FALSE)

#Subset data with a single data channel
subnews <- subset(news, data_channel_is_lifestyle == 1)

#Select variables for modeling and EDA
subnews <- subnews%>% select(n_tokens_title,n_tokens_content,num_imgs,average_token_length,is_weekend,global_rate_positive_words,shares,num_keywords)
subnews$is_weekend <- as.factor(subnews$is_weekend)
```
 
# Data Split  
In this part, our data set is split into training set and test set, with training set contains 70% of the data and test set contains the other 30%.  
```{r}
#Set seed for reproduction
set.seed(123)

#Split data
index <- createDataPartition(subnews$shares,p = 0.7,list = FALSE)
train <- subnews[index,]
test <- subnews[-index,]

```


# Summarizations and EDA  

In this part, basic summary statistics for the predictors are calculated. Also, some plots,including scatter plots, barplots, boxplots, frequency tables are generated to examine the relationship between the variables.  
```{r}
#Define function for producing summary statistics
sum <- function(x){
  min <- min(x)
  mean <- mean(x)
  median <- median(x)
  max <- max(x)
  sd <- sd(x)
  return(list(Minimum = min, Mean = mean, Median = median, Maximum = max, `Standard Deviation` = sd(x)))
}

#Calculate summary statistic for variables
sum(subnews$n_tokens_title)
sum(subnews$n_tokens_content)

```

After producing summary statistics, some plots and tables are shown below:  

## Frequency table  

Below shows the frequency table of number of keywords.  
```{r}
 table(train$num_keywords)
```

According to the table, most of the articles have more than 5 keywords. We assume that more keywords in the metadata will increase shares.  

## Scatter plots

Below are the scatter plots for the chosen variables.  
```{r}
ggplot(data = train, aes(x = global_rate_positive_words, y = shares))+
geom_point(aes(color = is_weekend)) +
  labs(x = "Rate of positive words in the content",
       y = "Number of Shares",
       title = "Scatter Plot of Shares vs Rate of positive words in the content") +
  scale_color_discrete(name = "Weekend Published", labels = c("No", "Yes"))
```

According to the scatter plot above, it seems that when the rate of positive words exceeds 0.075, the number of shares of the article is relatively small. Also, those articles with high shares are mostly published during weekdays rather than weekend.  

#Barplots

Below are the barplots of several variablesï¼š  

```{r}
# Create bar plot of predictor "is_weekend"
g <- ggplot(data = train, aes(x = is_weekend))
g + geom_bar(fill = "cyan2") +
  labs(title = "Bar Plot of is_weekend")
```